"use strict";(self.webpackChunkfadz_web_frontend=self.webpackChunkfadz_web_frontend||[]).push([[933],{7524:(e,s,a)=>{a.r(s),a.d(s,{default:()=>i});var t=a(5043),r=a(5475),n=a(3216),c=a(411),l=a(579);const i=()=>{const[e]=(0,r.ok)(),s=e.get("token"),[a,i]=(0,t.useState)(""),[o,d]=(0,t.useState)(""),[u,m]=(0,t.useState)(""),[h,p]=(0,t.useState)(!1),[x,v]=(0,t.useState)(!1),j=(0,n.Zp)();return s?(0,l.jsx)("div",{className:"reset-container",children:(0,l.jsxs)("div",{className:"reset-card",children:[(0,l.jsx)("div",{className:"icon-container",children:(0,l.jsxs)("svg",{className:"lock-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,l.jsx)("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),(0,l.jsx)("path",{d:"m7 11V7a5 5 0 0 1 10 0v4"})]})}),(0,l.jsx)("h1",{className:"title",children:"Reset Password"}),(0,l.jsx)("p",{className:"subtitle",children:"Create a new secure password for your account"}),(0,l.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const t=(a||"").trim(),r=(o||"").trim(),n=/[A-Z]/.test(t)&&/\d/.test(t)&&t.length>=6;if(t&&t===r)if(n)try{await c.Ay.post("/auth/reset-password",{token:s,newPassword:t}),alert("Password reset successful! You can now log in."),j("/")}catch(l){m("Reset failed. The link may be expired or invalid.")}else m("Password must be at least 6 characters and include an uppercase letter and a number.");else m("Passwords must match and not be empty")},className:"reset-form",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"New Password"}),(0,l.jsxs)("div",{className:"input-wrapper",children:[(0,l.jsx)("input",{type:h?"text":"password",placeholder:"Enter your new password",value:a,onChange:e=>i(e.target.value),required:!0,minLength:6,className:"form-input"}),(0,l.jsx)("button",{type:"button",className:"toggle-password-btn",onClick:()=>p(!h),children:(0,l.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:h?(0,l.jsx)("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,l.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})})})]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Confirm Password"}),(0,l.jsxs)("div",{className:"input-wrapper",children:[(0,l.jsx)("input",{type:x?"text":"password",placeholder:"Confirm your new password",value:o,onChange:e=>d(e.target.value),required:!0,minLength:6,className:"form-input"}),(0,l.jsx)("button",{type:"button",className:"toggle-password-btn",onClick:()=>v(!x),children:(0,l.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:x?(0,l.jsx)("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,l.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})})})]})]}),u&&(0,l.jsx)("div",{className:"error-message",children:u}),!u&&a&&(0,l.jsxs)("div",{style:{fontSize:12,marginTop:4},children:[(0,l.jsxs)("span",{style:{display:"block",color:/[A-Z]/.test(a)?"#2f855a":"#b91c1c"},children:["\u2022 At least one uppercase letter ",/[A-Z]/.test(a)?"\u2713":""]}),(0,l.jsxs)("span",{style:{display:"block",color:/\d/.test(a)?"#2f855a":"#b91c1c"},children:["\u2022 At least one number ",/\d/.test(a)?"\u2713":""]}),(0,l.jsxs)("span",{style:{display:"block",color:a.length>=6?"#2f855a":"#b91c1c"},children:["\u2022 Minimum 6 characters ",a.length>=6?"\u2713":""]})]}),(0,l.jsx)("button",{type:"submit",className:"submit-button",children:"Set New Password"})]})]})}):(0,l.jsx)("div",{children:"Invalid reset password link"})}},7922:(e,s,a)=>{a.r(s),a.d(s,{default:()=>o});var t=a(9379),r=a(5043),n=a(3204),c=a(411),l=a(5319),i=a(579);const o=e=>{let{email:s,onSuccess:a,forceUserUpdate:o}=e;const[d,u]=(0,r.useState)(""),[m,h]=(0,r.useState)(!0),[p,x]=(0,r.useState)(""),[v,j]=(0,r.useState)(0),[f,b]=(0,r.useState)(!1),[g,w]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{if(!v)return;const e=setInterval((()=>j((s=>s<=1?(clearInterval(e),0):s-1))),1e3);return()=>clearInterval(e)}),[v]),(0,i.jsxs)("div",{className:"two-fa-container",children:[(0,i.jsxs)("div",{className:"two-fa-header",children:[(0,i.jsxs)("div",{className:"two-fa-title-row",children:[(0,i.jsx)(n.SMR,{className:"two-fa-icon",size:24}),(0,i.jsx)("h2",{className:"two-fa-title",children:"Two-Factor Authentication"})]}),(0,i.jsxs)("p",{className:"two-fa-subtitle",children:["We sent a verification code to ",(0,i.jsx)("strong",{children:s})]})]}),(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),6===d.length){b(!0),x("");try{const{data:e}=await c.Ay.post("/auth/verify-2fa",{email:s,code:d,rememberDevice:m});(0,c.ki)(e.accessToken,{accessTokenExpiresAt:e.accessTokenExpiresAt});const r=(0,l.gV)((0,t.A)({},e.user));a&&a(e.accessToken,r),o&&o()}catch(i){var r,n;x((null===i||void 0===i||null===(r=i.response)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.msg)||"Verification failed.")}finally{b(!1)}}},className:"two-fa-form",children:[(0,i.jsxs)("div",{className:"verification-input-group",children:[(0,i.jsxs)("label",{htmlFor:"verification-code",className:"verification-label",children:[(0,i.jsx)(n.maD,{className:"input-icon"}),"ENTER VERIFICATION CODE"]}),(0,i.jsx)("input",{id:"verification-code",type:"text",inputMode:"numeric",autoComplete:"one-time-code",placeholder:"Enter 6-digit code",value:d,onChange:e=>u(e.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6,className:"verification-input",required:!0})]}),(0,i.jsx)("div",{className:"remember-device-group",children:(0,i.jsxs)("label",{className:"remember-device-label",children:[(0,i.jsx)("input",{type:"checkbox",checked:m,onChange:e=>h(e.target.checked),className:"remember-checkbox"}),(0,i.jsx)("span",{className:"checkbox-custom"}),(0,i.jsx)("span",{className:"remember-text",children:"Remember this device for 30 days"})]})}),(0,i.jsx)("button",{type:"submit",className:"verify-button ".concat(f?"loading":""),disabled:f||6!==d.length,children:f?(0,i.jsxs)("span",{className:"loading-content",children:[(0,i.jsx)("span",{className:"spinner"}),"Verifying..."]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.A7C,{className:"button-icon"}),"Verify Code"]})})]}),(0,i.jsx)("div",{className:"resend-section",children:(0,i.jsx)("button",{onClick:async()=>{if(!(v>0)){w(!0),x("");try{const e=await c.Ay.post("/auth/resend-2fa",{email:s});x(e.data.msg||"Code resent successfully."),j(30)}catch(t){var e,a;x((null===t||void 0===t||null===(e=t.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.msg)||"Error resending code.")}finally{w(!1)}}},disabled:v>0||g,className:"resend-button ".concat(v>0?"disabled":""),children:v>0?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.w_X,{className:"button-icon"}),"Resend in ",v,"s"]}):g?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"spinner"}),"Sending..."]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.maD,{className:"button-icon"}),"Resend Code"]})})}),p&&(0,i.jsx)("div",{className:"message-display ".concat(p.includes("successfully")?"success":"error"),children:(0,i.jsx)("span",{className:"message-text",children:p})})]})}},9631:(e,s,a)=>{a.r(s),a.d(s,{default:()=>i});var t=a(5043),r=a(5475),n=a(3216),c=a(411),l=a(579);const i=()=>{const[e]=(0,r.ok)(),s=e.get("token"),[a,i]=(0,t.useState)(""),[o,d]=(0,t.useState)(""),[u,m]=(0,t.useState)(""),[h,p]=(0,t.useState)(!1),[x,v]=(0,t.useState)(!1),j=(0,n.Zp)();return s?(0,l.jsx)("div",{className:"activation-container",children:(0,l.jsxs)("div",{className:"activation-card",children:[(0,l.jsx)("div",{className:"icon-container",children:(0,l.jsxs)("svg",{className:"check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,l.jsx)("path",{d:"M9 12l2 2 4-4"}),(0,l.jsx)("circle",{cx:"12",cy:"12",r:"9"})]})}),(0,l.jsx)("h1",{className:"title",children:"Activate Your Account"}),(0,l.jsx)("p",{className:"subtitle",children:"Set up your password to complete account activation"}),(0,l.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const t=(a||"").trim(),r=(o||"").trim(),n=/[A-Z]/.test(t)&&/\d/.test(t)&&t.length>=6;if(t&&t===r)if(n)try{await c.Ay.post("/auth/activate-account",{token:s,password:t}),alert("Account activated! You can now log in."),j("/")}catch(d){var l,i;const e=(null===d||void 0===d||null===(l=d.response)||void 0===l||null===(i=l.data)||void 0===i?void 0:i.msg)||"";if(/already activated/i.test(e))return alert("Account was already activated. You can log in now."),void j("/");/invalid|expired|token/i.test(e)?m("Activation failed. The link may be expired or invalid."):m(e||"Activation failed. Please try again later.")}else m("Password must be at least 6 characters and include an uppercase letter and a number.");else m("Passwords must match and not be empty")},className:"activation-form",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"New Password"}),(0,l.jsxs)("div",{className:"input-wrapper",children:[(0,l.jsx)("input",{type:h?"text":"password",placeholder:"Create your password",value:a,onChange:e=>i(e.target.value),required:!0,minLength:6,className:"form-input"}),(0,l.jsx)("button",{type:"button",className:"toggle-password-btn",onClick:()=>p(!h),children:(0,l.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:h?(0,l.jsx)("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,l.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})})})]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"Confirm Password"}),(0,l.jsxs)("div",{className:"input-wrapper",children:[(0,l.jsx)("input",{type:x?"text":"password",placeholder:"Confirm your password",value:o,onChange:e=>d(e.target.value),required:!0,minLength:6,className:"form-input"}),(0,l.jsx)("button",{type:"button",className:"toggle-password-btn",onClick:()=>v(!x),children:(0,l.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:x?(0,l.jsx)("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,l.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})})})]})]}),u&&(0,l.jsx)("div",{className:"error-message",children:u}),!u&&a&&(0,l.jsxs)("div",{style:{fontSize:12,marginTop:4,color:/[^A-Z]/.test(a)||/[^0-9]/.test(a)?"#555":"#2f855a"},children:[(0,l.jsxs)("span",{style:{display:"block",color:/[A-Z]/.test(a)?"#2f855a":"#b91c1c"},children:["\u2022 At least one uppercase letter ",/[A-Z]/.test(a)?"\u2713":""]}),(0,l.jsxs)("span",{style:{display:"block",color:/\d/.test(a)?"#2f855a":"#b91c1c"},children:["\u2022 At least one number ",/\d/.test(a)?"\u2713":""]}),(0,l.jsxs)("span",{style:{display:"block",color:a.length>=6?"#2f855a":"#b91c1c"},children:["\u2022 Minimum 6 characters ",a.length>=6?"\u2713":""]})]}),(0,l.jsx)("button",{type:"submit",className:"submit-button",children:"Set Password & Activate"})]})]})}):(0,l.jsx)("div",{children:"Invalid activation link"})}}}]);
//# sourceMappingURL=auth.61b72260.chunk.js.map